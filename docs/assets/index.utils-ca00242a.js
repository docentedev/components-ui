var T=Object.defineProperty;var C=(o,t,e)=>t in o?T(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var h=(o,t,e)=>(C(o,typeof t!="symbol"?t+"":t,e),e);const S=(o,t)=>{window.scrollTo({top:o,left:t,behavior:"smooth"})},x=o=>{if(o){const t=o,{top:e,left:n,width:i,height:a}=t.getBoundingClientRect();return{top:e-16,left:n-16,width:i+32,height:a+32}}return{top:0,left:0}},A=o=>{for(;o.firstChild;)o.removeChild(o.firstChild)},E=(o,t)=>{const e=document.querySelector(d(o,t));return e?{node:e,step:t}:t>300?{node:void 0,step:0}:E(o,t+1)},b=(o,t)=>{const e=document.querySelector(d(o,t));return e?{node:e,step:t}:t<0?{node:void 0,step:0}:b(o,t-1)},d=(o,t)=>`[data-components-ui_tourguide="${o}"][data-step="${t}"][data-components-ui_tourguide-type="backdrop"]`,q=(o,t)=>`[data-components-ui_tourguide="${o}"][data-step="${t}"][data-components-ui_tourguide-type="wrapper"]`,f=()=>'[data-components-ui_tourguide-type="backdrop"][data-open="true"]',g=()=>'[data-components-ui_tourguide-type="wrapper"][data-open="true"]';class N{constructor(){h(this,"list",{});window.addEventListener("resize",this.updatePositionCard),window.addEventListener("scroll",this.updatePositionCard)}recieveTourGuideEvent(t){const{tour:e}=t;t.action==="add"&&e&&this.addTour(e,t),t.action==="open"&&t.step!==void 0&&e&&this.openTour(e,t.step),t.action==="open"&&t.step===void 0&&e&&(t.action="close_all",this.closeAll(e)),t.action==="close_all"&&this.closeCurrentOpen()}updatePositionCard(){const t=document.querySelector(f()),e=document.querySelector(g());if(!t||!e)return;const n=e==null?void 0:e.firstChild,i=x(n);t.style.cssText=`top: ${i.top}px; left: ${i.left}px; width: ${i.width}px; height: ${i.height}px;`}closeCurrentOpen(){const t=document.querySelector(f()),e=document.querySelector(g());!t||!e||(t.setAttribute("data-open","false"),e.setAttribute("data-open","false"))}closeAll(t){this.list[t].map(s=>s.step).map(s=>{if(s!==void 0)return document.querySelector(d(t,s))}).forEach(s=>{s&&s.setAttribute("data-open","false")});const i=`[data-components-ui_tourguide="${t}"][data-components-ui_tourguide-type="wrapper"]`;document.querySelectorAll(i).forEach(s=>{s&&s.setAttribute("data-open","false")})}addTour(t,e){this.list[t]||(this.list[t]=[]);const n=this.list[t].findIndex(i=>i.step===e.step);n!==-1?this.list[t][n]=e:this.list[t].push(e),this.orderTour(t)}orderTour(t){this.list[t].sort((e,n)=>e.step!==void 0&&n.step!==void 0?e.step-n.step:0)}find(t,e){return this.list[t].find(n=>n.step===e)}openTour(t,e){if(!this.find(t,e)){this.closeAll(t);return}const a=this.list[t].map(r=>r.step).map(r=>{if(r===void 0)return;const _=d(t,r);return document.querySelector(_)}),s=d(t,e),u=q(t,e),c=document.querySelector(s),p=document.querySelector(u);if(this.closeAll(t),!c||!p)return;c.setAttribute("data-open","true"),p.setAttribute("data-open","true");const l=c.querySelector('[data-type="chip"]');A(l);const w=e+1+"/"+a.filter(r=>r).length,v=document.createTextNode(w);l.appendChild(v),this.updatePositionCard();const m=document.querySelector(u);S(m.offsetTop,m.offsetLeft)}printList(){console.log(this.list)}}const $=()=>{const o=new N;window.addEventListener("components-ui-tour-guide",t=>{const e=t.detail;o.recieveTourGuideEvent(e)})},k=(()=>{let o;return()=>{o||(o=!0,$())}})();k();const P=()=>{const o=document.createElement("style");o.id="__components-ui_tour-guide";const t=`
    [data-components-ui_tourguide-type="backdrop"][data-open="false"] {
        opacity: 0;
        pointer-events: none;
        position: fixed;
    }
    [data-components-ui_tourguide-type="wrapper"][data-open="false"] {
    }
    [data-components-ui_tourguide-type="backdrop"][data-open="true"] {
        opacity: 1;
        pointer-events: all;
    }
    [data-components-ui_tourguide-type="backdrop"][data-open="false"] > div:last-child {
        transform: translateY(0.25rem);
        opacity: 0;
    }
    [data-components-ui_tourguide-type="backdrop"][data-open="true"] > div:last-child {
        transform: translateY(0);
        opacity: 1;
        transition: transform 0.25s;
    }
    `;o.appendChild(document.createTextNode(t)),document.getElementById("__components-ui_tour-guide")||document.head.appendChild(o)},L=(o,t)=>{const e={action:"add",tour:o,step:t};window.dispatchEvent(new CustomEvent("components-ui-tour-guide",{detail:e}))},y=(o,t)=>{const e={action:"open",tour:o,step:t};window.dispatchEvent(new CustomEvent("components-ui-tour-guide",{detail:e}))},B=o=>({onClick:t=>{const e=t.currentTarget.getAttribute("data-step"),n=e?parseInt(e):void 0;y(o,n)},open:t=>y(o,t),closeAll:()=>{const t={action:"close_all"};window.dispatchEvent(new CustomEvent("components-ui-tour-guide",{detail:t}))},total:()=>document.querySelectorAll(`[data-components-ui_tourguide-type="wrapper"][data-components-ui_tourguide="${o}"]`).length});export{b as a,L as b,P as g,E as r,B as t};
