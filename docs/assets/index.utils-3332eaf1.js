var S=Object.defineProperty;var T=(o,t,e)=>t in o?S(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var y=(o,t,e)=>(T(o,typeof t!="symbol"?t+"":t,e),e);const x=o=>{if(o){const{top:t,left:e,width:n,height:r}=o.getBoundingClientRect(),c=window.innerHeight,i=window.innerWidth,l=t+r/2<c/2,d=e+n/2<i/2;return{isAbove:l,isLeft:d}}return{isAbove:!1,isLeft:!1}},E=o=>{if(o){const t=o,{top:e,left:n,width:r,height:c}=t.getBoundingClientRect();return{top:e-16,left:n-16,width:r+32,height:c+32}}return{top:0,left:0}},q=o=>{for(;o.firstChild;)o.removeChild(o.firstChild)},N=(o,t)=>{const e=document.querySelector(p(o,t));return e?{node:e,step:t}:t>300?{node:void 0,step:0}:N(o,t+1)},k=(o,t)=>{const e=document.querySelector(p(o,t));return e?{node:e,step:t}:t<0?{node:void 0,step:0}:k(o,t-1)},p=(o,t)=>`[data-components-ui_tourguide="${o}"][data-step="${t}"][data-components-ui_tourguide-type="backdrop"]`,L=(o,t)=>`[data-components-ui_tourguide="${o}"][data-step="${t}"][data-components-ui_tourguide-type="wrapper"]`,v=()=>'[data-components-ui_tourguide-type="backdrop"][data-open="true"]',_=()=>'[data-components-ui_tourguide-type="wrapper"][data-open="true"]';class ${constructor(){y(this,"list",{});window.addEventListener("resize",this.updatePositionCard),window.addEventListener("scroll",this.updatePositionCard)}recieveTourGuideEvent(t){const{tour:e}=t;t.action==="add"&&e&&this.addTour(e,t),t.action==="open"&&t.step!==void 0&&e&&this.openTour(e,t.step),t.action==="open"&&t.step===void 0&&e&&(t.action="close_all",this.closeAll(e)),t.action==="close_all"&&this.closeCurrentOpen()}updatePositionCard(){const t=document.querySelector(v()),e=document.querySelector(_());if(!t||!e)return;const n=e==null?void 0:e.firstChild,r=E(n);t.dataset.variant!=="modal"&&(t.style.cssText=`top: ${r.top}px; left: ${r.left}px; width: ${r.width}px; height: ${r.height}px;`)}closeCurrentOpen(){const t=document.querySelector(v()),e=document.querySelector(_());!t||!e||(t.setAttribute("data-open","false"),e.setAttribute("data-open","false"))}closeAll(t){this.list[t].map(i=>i.step).map(i=>{if(i!==void 0)return document.querySelector(p(t,i))}).forEach(i=>{i&&i.setAttribute("data-open","false")});const r=`[data-components-ui_tourguide="${t}"][data-components-ui_tourguide-type="wrapper"]`;document.querySelectorAll(r).forEach(i=>{i&&i.setAttribute("data-open","false")})}addTour(t,e){this.list[t]||(this.list[t]=[]);const n=this.list[t].findIndex(r=>r.step===e.step);n!==-1?this.list[t][n]=e:this.list[t].push(e),this.orderTour(t)}orderTour(t){this.list[t].sort((e,n)=>e.step!==void 0&&n.step!==void 0?e.step-n.step:0)}find(t,e){return this.list[t].find(n=>n.step===e)}openTour(t,e){if(!this.find(t,e)){this.closeAll(t);return}const c=this.list[t].map(s=>s.step).map(s=>{if(s===void 0)return;const a=p(t,s);return document.querySelector(a)}),i=p(t,e),l=L(t,e),d=document.querySelector(i),m=document.querySelector(l),f=c.filter(s=>(s==null?void 0:s.dataset.step)&&parseInt(s.dataset.step)<e).length+1;if(this.closeAll(t),!d||!m)return;d.setAttribute("data-open","true"),m.setAttribute("data-open","true");const g=c.filter(s=>s).length,h=d.querySelector('[data-components-ui_tourguide-type="chip"]');d.dataset.total=g.toString(),d.dataset.current=f.toString(),h&&q(h);const A=f+"/"+g,C=document.createTextNode(A);h&&h.appendChild(C),this.updatePositionCard();const w=document.querySelector(l);w.scrollIntoView({behavior:"auto",block:"center",inline:"nearest"});const u=d.querySelector('[data-components-ui_tourguide-type="content"]');if(u){const s=u.dataset.position;if(s==="auto"){const a=x(w);a.isLeft&&a.isAbove?u.dataset.position="right":!a.isLeft&&a.isAbove?u.dataset.position="left":a.isLeft&&!a.isAbove?u.dataset.position="bottom-right":!a.isLeft&&!a.isAbove&&(u.dataset.position="right"),console.log(a,s)}}}printList(){console.log(this.list)}}const G=()=>{const o=new $;window.addEventListener("components-ui-tour-guide",t=>{const e=t.detail;o.recieveTourGuideEvent(e)})},I=(()=>{let o;return()=>{o||(o=!0,G())}})();I();const O=()=>{const o=document.createElement("style");o.id="__components-ui_tour-guide";const t=`
    [data-components-ui_tourguide-type="backdrop"][data-open="false"] {
        opacity: 0;
        pointer-events: none;
        position: fixed;
    }
    [data-components-ui_tourguide-type="wrapper"][data-open="false"] {
    }
    [data-components-ui_tourguide-type="backdrop"][data-open="true"] {
        opacity: 1;
        pointer-events: all;
        z-index: 9999;
    }
    [data-components-ui_tourguide-type="backdrop"][data-open="false"] > div:last-child {
        transform: translateY(0.25rem);
        opacity: 0;
    }
    [data-components-ui_tourguide-type="backdrop"][data-open="true"] > div:last-child {
        transform: translateY(0);
        opacity: 1;
        transition: transform 0.25s;
    }
    `;o.appendChild(document.createTextNode(t)),document.getElementById("__components-ui_tour-guide")||document.head.appendChild(o)},W=(o,t)=>{const e={action:"add",tour:o,step:t};window.dispatchEvent(new CustomEvent("components-ui-tour-guide",{detail:e}))},b=(o,t)=>{const e={action:"open",tour:o,step:t};window.dispatchEvent(new CustomEvent("components-ui-tour-guide",{detail:e}))},z=o=>({onClick:t=>{const e=t.currentTarget.getAttribute("data-step"),n=e?parseInt(e):void 0;b(o,n)},open:t=>b(o,t),closeAll:()=>{const t={action:"close_all"};window.dispatchEvent(new CustomEvent("components-ui-tour-guide",{detail:t}))},total:()=>document.querySelectorAll(`[data-components-ui_tourguide-type="wrapper"][data-components-ui_tourguide="${o}"]`).length});export{k as a,W as b,x as d,O as g,N as r,z as t};
