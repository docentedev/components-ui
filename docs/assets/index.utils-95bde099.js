var S=Object.defineProperty;var x=(o,t,e)=>t in o?S(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var g=(o,t,e)=>(x(o,typeof t!="symbol"?t+"":t,e),e);const A=(o,t)=>{window.scrollTo({top:o,left:t,behavior:"smooth"})},E=o=>{if(o){const t=o,{top:e,left:n,width:r,height:a}=t.getBoundingClientRect();return{top:e-16,left:n-16,width:r+32,height:a+32}}return{top:0,left:0}},b=o=>{for(;o.firstChild;)o.removeChild(o.firstChild)},q=(o,t)=>{const e=document.querySelector(c(o,t));return e?{node:e,step:t}:t>300?{node:void 0,step:0}:q(o,t+1)},N=(o,t)=>{const e=document.querySelector(c(o,t));return e?{node:e,step:t}:t<0?{node:void 0,step:0}:N(o,t-1)},c=(o,t)=>`[data-components-ui_tourguide="${o}"][data-step="${t}"][data-components-ui_tourguide-type="backdrop"]`,$=(o,t)=>`[data-components-ui_tourguide="${o}"][data-step="${t}"][data-components-ui_tourguide-type="wrapper"]`,y=()=>'[data-components-ui_tourguide-type="backdrop"][data-open="true"]',w=()=>'[data-components-ui_tourguide-type="wrapper"][data-open="true"]';class k{constructor(){g(this,"list",{});window.addEventListener("resize",this.updatePositionCard),window.addEventListener("scroll",this.updatePositionCard)}recieveTourGuideEvent(t){const{tour:e}=t;t.action==="add"&&e&&this.addTour(e,t),t.action==="open"&&t.step!==void 0&&e&&this.openTour(e,t.step),t.action==="open"&&t.step===void 0&&e&&(t.action="close_all",this.closeAll(e)),t.action==="close_all"&&this.closeCurrentOpen()}updatePositionCard(){const t=document.querySelector(y()),e=document.querySelector(w());if(!t||!e)return;const n=e==null?void 0:e.firstChild,r=E(n);t.dataset.variant!=="modal"&&(t.style.cssText=`top: ${r.top}px; left: ${r.left}px; width: ${r.width}px; height: ${r.height}px;`)}closeCurrentOpen(){const t=document.querySelector(y()),e=document.querySelector(w());!t||!e||(t.setAttribute("data-open","false"),e.setAttribute("data-open","false"))}closeAll(t){this.list[t].map(s=>s.step).map(s=>{if(s!==void 0)return document.querySelector(c(t,s))}).forEach(s=>{s&&s.setAttribute("data-open","false")});const r=`[data-components-ui_tourguide="${t}"][data-components-ui_tourguide-type="wrapper"]`;document.querySelectorAll(r).forEach(s=>{s&&s.setAttribute("data-open","false")})}addTour(t,e){this.list[t]||(this.list[t]=[]);const n=this.list[t].findIndex(r=>r.step===e.step);n!==-1?this.list[t][n]=e:this.list[t].push(e),this.orderTour(t)}orderTour(t){this.list[t].sort((e,n)=>e.step!==void 0&&n.step!==void 0?e.step-n.step:0)}find(t,e){return this.list[t].find(n=>n.step===e)}openTour(t,e){if(!this.find(t,e)){this.closeAll(t);return}const a=this.list[t].map(i=>i.step).map(i=>{if(i===void 0)return;const C=c(t,i);return document.querySelector(C)}),s=c(t,e),u=$(t,e),d=document.querySelector(s),p=document.querySelector(u),l=a.filter(i=>(i==null?void 0:i.dataset.step)&&parseInt(i.dataset.step)<e).length+1;if(this.closeAll(t),!d||!p)return;d.setAttribute("data-open","true"),p.setAttribute("data-open","true");const m=a.filter(i=>i).length,h=d.querySelector('[data-components-ui_tourguide-type="chip"]');d.dataset.total=m.toString(),d.dataset.current=l.toString(),b(h);const _=l+"/"+m,T=document.createTextNode(_);h.appendChild(T),this.updatePositionCard();const f=document.querySelector(u);A(f.offsetTop,f.offsetLeft)}printList(){console.log(this.list)}}const G=()=>{const o=new k;window.addEventListener("components-ui-tour-guide",t=>{const e=t.detail;o.recieveTourGuideEvent(e)})},P=(()=>{let o;return()=>{o||(o=!0,G())}})();P();const B=()=>{const o=document.createElement("style");o.id="__components-ui_tour-guide";const t=`
    [data-components-ui_tourguide-type="backdrop"][data-open="false"] {
        opacity: 0;
        pointer-events: none;
        position: fixed;
    }
    [data-components-ui_tourguide-type="wrapper"][data-open="false"] {
    }
    [data-components-ui_tourguide-type="backdrop"][data-open="true"] {
        opacity: 1;
        pointer-events: all;
    }
    [data-components-ui_tourguide-type="backdrop"][data-open="false"] > div:last-child {
        transform: translateY(0.25rem);
        opacity: 0;
    }
    [data-components-ui_tourguide-type="backdrop"][data-open="true"] > div:last-child {
        transform: translateY(0);
        opacity: 1;
        transition: transform 0.25s;
    }
    `;o.appendChild(document.createTextNode(t)),document.getElementById("__components-ui_tour-guide")||document.head.appendChild(o)},O=(o,t)=>{const e={action:"add",tour:o,step:t};window.dispatchEvent(new CustomEvent("components-ui-tour-guide",{detail:e}))},v=(o,t)=>{const e={action:"open",tour:o,step:t};window.dispatchEvent(new CustomEvent("components-ui-tour-guide",{detail:e}))},W=o=>({onClick:t=>{const e=t.currentTarget.getAttribute("data-step"),n=e?parseInt(e):void 0;v(o,n)},open:t=>v(o,t),closeAll:()=>{const t={action:"close_all"};window.dispatchEvent(new CustomEvent("components-ui-tour-guide",{detail:t}))},total:()=>document.querySelectorAll(`[data-components-ui_tourguide-type="wrapper"][data-components-ui_tourguide="${o}"]`).length});export{N as a,O as b,B as g,q as r,W as t};
