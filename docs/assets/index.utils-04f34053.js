var f=Object.defineProperty;var w=(o,t,e)=>t in o?f(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var l=(o,t,e)=>(w(o,typeof t!="symbol"?t+"":t,e),e);const y=(o,t)=>{window.scrollTo({top:o,left:t,behavior:"smooth"})},d=o=>{if(o){const t=o,{top:e,left:s,width:n,height:r}=t.getBoundingClientRect();return{top:e-4,left:s-4,width:n+8,height:r+8}}return{top:0,left:0}},m=o=>{for(;o.firstChild;)o.removeChild(o.firstChild)};class g{constructor(){l(this,"list",{});window.addEventListener("resize",this.updatePositionCard),window.addEventListener("scroll",this.updatePositionCard)}recieveTourGuideEvent(t){const{tour:e}=t;t.action==="add"&&e&&this.addTour(e,t),t.action==="open"&&t.step!==void 0&&e&&this.openTour(e,t.step),t.action==="open"&&t.step===void 0&&e&&(t.action="close_all",this.closeAll(e)),t.action==="close_all"&&this.closeCurrentOpen()}updatePositionCard(){const t=document.querySelector('[data-tourguide-type="backdrop"][data-open="true"]'),e=document.querySelector('[data-tourguide-type="wrapper"][data-open="true"]');if(!t||!e)return;const s=e==null?void 0:e.firstChild;t.style.top=`${d(s).top}px`,t.style.left=`${d(s).left}px`,t.style.width=`${d(s).width}px`,t.style.height=`${d(s).height}px`}closeCurrentOpen(){const t=document.querySelector('[data-tourguide-type="backdrop"][data-open="true"]'),e=document.querySelector('[data-tourguide-type="wrapper"][data-open="true"]');!t||!e||(t.style.display="none",t.setAttribute("data-open","false"),e.setAttribute("data-open","false"))}closeAll(t){this.list[t].map(i=>i.step).map(i=>{const a=`[data-tourguide="${t}"][data-step="${i}"][data-tourguide-type="backdrop"]`;return document.querySelector(a)}).forEach(i=>{i.style.display="none",i.setAttribute("data-open","false")});const n=`[data-tourguide="${t}"][data-tourguide-type="wrapper"]`;document.querySelectorAll(n).forEach(i=>{i&&i.setAttribute("data-open","false")})}addTour(t,e){this.list[t]||(this.list[t]=[]);const s=this.list[t].findIndex(n=>n.step===e.step);s!==-1?this.list[t][s]=e:this.list[t].push(e),this.orderTour(t)}orderTour(t){this.list[t].sort((e,s)=>e.step!==void 0&&s.step!==void 0?e.step-s.step:0)}find(t,e){return this.list[t].find(s=>s.step===e)}openTour(t,e){if(!this.find(t,e)){this.closeAll(t);return}const n=`[data-tourguide="${t}"][data-step="${e}"][data-tourguide-type="backdrop"]`,r=`[data-tourguide="${t}"][data-step="${e}"][data-tourguide-type="wrapper"]`,i=document.querySelector(n),a=document.querySelector(r);this.closeAll(t),i.style.display="block",i.setAttribute("data-open","true"),a.setAttribute("data-open","true");const u=i.querySelector('[data-type="chip"]');m(u);const p=e+1+"/"+this.list[t].length,h=document.createTextNode(p);u.appendChild(h),this.updatePositionCard();const c=document.querySelector(r);y(c.offsetTop,c.offsetLeft)}printList(){console.log(this.list)}}const T=()=>{const o=new g;window.addEventListener("components-ui-tour-guide",t=>{const e=t.detail;o.recieveTourGuideEvent(e)})},C=(()=>{console.log("startTourGuide");let o;return()=>{o||(o=!0,T())}})();C();const E=(o,t)=>{const e={action:"add",tour:o,step:t};window.dispatchEvent(new CustomEvent("components-ui-tour-guide",{detail:e}))},v=(o,t)=>{const e={action:"open",tour:o,step:t};window.dispatchEvent(new CustomEvent("components-ui-tour-guide",{detail:e}))},$=o=>({open:t=>v(o,t),closeAll:()=>{const t={action:"close_all"};window.dispatchEvent(new CustomEvent("components-ui-tour-guide",{detail:t}))},total:()=>document.querySelectorAll(`[data-tourguide-type="wrapper"][data-tourguide="${o}"]`).length});export{E as r,$ as t};
